name: Debug PRoot Build

on: workflow_dispatch

jobs:
  debug-build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout PRoot
      uses: actions/checkout@v4
      with:
        repository: termux/proot

    - name: Install tools
      run: |
        sudo apt-get update
        sudo apt-get install -y \
          build-essential \
          libtool automake \
          pkg-config \
          libtalloc-dev \
          file

    - name: Try native build
      run: |
        cd src
        make -f GNUmakefile V=1
        file proot
        ./proot --version || echo "Version check failed but binary exists"

    - name: Check build requirements
      run: |
        cd src
        cat GNUmakefile | head -20
        echo "Build files:"
        ls -la
